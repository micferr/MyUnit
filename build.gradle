apply plugin: 'java'

task compileJavaClasses (type: JavaCompile)
task runSelfTestSuite (type: JavaExec)

compileJavaClasses {
 source = fileTree(dir: 'src', include: '**/*.java')
 destinationDir = file('build/classes/main')
 classpath = files('build/classes/main')
}

runSelfTestSuite {
  classpath sourceSets.main.runtimeClasspath
  main = "com.myunit.selftest.SelfTestSuite"
}
tasks.runSelfTestSuite.dependsOn(compileJavaClasses)